<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>量子表情認識 - リアルタイム感情分析</title>
    <link rel="stylesheet" href="style.css">
    <!-- Face-API.js ライブラリ -->
    <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
    <!-- Chart.js ライブラリ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.0.1/build/global/luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.2.0/dist/chartjs-adapter-luxon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-streaming@2.0.0/dist/chartjs-plugin-streaming.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="app-title">量子表情認識</h1>
            <p class="app-subtitle">AIによるリアルタイム感情分析</p>
        </header>

        <div class="tabs">
            <button class="tab-btn" data-tab="upload">画像アップロード</button>
            <button class="tab-btn" data-tab="capture">カメラ撮影</button>
            <button class="tab-btn active" data-tab="realtime">リアルタイム分析</button>
        </div>

        <!-- タブコンテンツ -->
        <div class="tab-content">
            <!-- 画像アップロードタブ -->
            <div class="tab-pane" id="upload-tab">
                <div class="upload-container">
                    <div class="upload-box">
                        <input type="file" id="upload-input" accept="image/*" class="hidden">
                        <label for="upload-input" class="upload-label">
                            <div class="upload-icon"></div>
                            <span>クリックして画像をアップロード</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- カメラ撮影タブ -->
            <div class="tab-pane" id="capture-tab">
                <div class="capture-container">
                    <div class="camera-preview">
                        <video id="capture-video" autoplay muted></video>
                        <button id="take-photo" class="btn btn--primary">写真を撮影</button>
                        <canvas id="capture-canvas" class="hidden"></canvas>
                    </div>
                </div>
            </div>

            <!-- リアルタイム分析タブ (デフォルトで表示) -->
            <div class="tab-pane active" id="realtime-tab">
                <div class="realtime-container">
                    <!-- モデルロード状態 -->
                    <div id="loading-container" class="loading-overlay">
                        <div class="quantum-loader">
                            <div class="quantum-spinner"></div>
                        </div>
                        <p id="loading-status">Face-API.jsモデルを読み込み中...</p>
                    </div>

                    <!-- カメラ映像とオーバーレイ -->
                    <div class="video-container">
                        <video id="video" autoplay muted playsinline></video>
                        <canvas id="overlay" class="face-overlay"></canvas>
                    </div>
                    
                    <!-- コントロールパネル -->
                    <div class="control-panel">
                        <button id="start-button" class="btn btn--primary">開始</button>
                        <button id="stop-button" class="btn btn--secondary" disabled>停止</button>
                    </div>

                    <!-- 統計情報パネル -->
                    <div class="stats-container">
                        <div class="stats-card">
                            <div class="stats-icon frame-icon"></div>
                            <div class="stats-info">
                                <h3>分析フレーム</h3>
                                <p id="frame-count">0</p>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-icon confidence-icon"></div>
                            <div class="stats-info">
                                <h3>平均信頼度</h3>
                                <p id="avg-confidence">0%</p>
                            </div>
                        </div>
                        <div class="stats-card">
                            <div class="stats-icon emotion-icon"></div>
                            <div class="stats-info">
                                <h3>現在の表情</h3>
                                <p id="current-emotion">未検出</p>
                            </div>
                        </div>
                    </div>

                    <!-- 感情グラフ -->
                    <div class="chart-container">
                        <canvas id="emotion-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>